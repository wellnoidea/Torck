

	var listener = new Box2D.Dynamics.b2ContactListener;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	listener.PreSolve = function(contact, oldManifold) {
		////////// A One Sided Platform, a True Classic //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		var fixtureA = contact.GetFixtureA();
		var fixtureB = contact.GetFixtureB();
		// check if the bodies colliding are torck and a one sided platform
		if ((fixtureA.GetBody().GetUserData() === 'torck' && fixtureB.GetBody().GetUserData() === 'oneSidedUpDown') 
			|| (fixtureA.GetBody().GetUserData() === 'oneSidedUpDown' && fixtureB.GetBody().GetUserData() === 'torck')){

			// determining if the fixtureA represents the platform ('oneSidedUpDown') or the player ('torck')
			switch (fixtureA.GetBody().GetUserData()) {
				case 'oneSidedUpDown' :
					// determining y positions
					var torckPosY = fixtureB.GetBody().GetPosition().y * SCALE;
					var oneSidedUpDownPosY = fixtureA.GetBody().GetPosition().y * SCALE;
					break;
				case 'torck' :
					// determining y positions
					var torckPosY = fixtureA.GetBody().GetPosition().y * SCALE;
					var oneSidedUpDownPosY =fixtureB.GetBody().GetPosition().y * SCALE;
					break;
			}
			// checking distance between bodies
			var distance = torckPosY - oneSidedUpDownPosY;
			// if the distance is greater than player radius + the platform height...
			// the +1 is a buffer to avoid glitches
			// possible to do: a short temporary jump lock when the skull reaches the platform might avoid overly 'jumpy' behaviour
			if (distance > - (torck.size / 2 + 20) + 1) {
				// don't manage the contact
				contact.SetEnabled(false);
			}
		}
	}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	listener.BeginContact = function(contact) {
		if ((contact.GetFixtureA().GetBody().m_userData === 'torck' && contact.GetFixtureB().GetBody().m_userData === 'ground') ||
			(contact.GetFixtureA().GetBody().m_userData === 'ground' && contact.GetFixtureB().GetBody().m_userData === 'torck')) {
			// torck.contacts++;
			if (sound_is_active) {
				collision.currentTime = 0.07;
				collision.play(); // Reenable to get the collision sound
			}
		}
		if (contact.GetFixtureA().GetBody().m_userData === 'infraSensor' || contact.GetFixtureB().GetBody().m_userData === 'infraSensor') {
			torck.contacts++;
		}
	}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	listener.EndContact = function(contact) {

/*      if ((contact.GetFixtureA().GetBody().m_userData === 'torck' && contact.GetFixtureB().GetBody().m_userData === 'ground') ||
			(contact.GetFixtureA().GetBody().m_userData === 'ground' && contact.GetFixtureB().GetBody().m_userData === 'torck')) {
			// torck.contacts--;
		}*/
		if (contact.GetFixtureA().GetBody().m_userData === 'infraSensor' || contact.GetFixtureB().GetBody().m_userData === 'infraSensor') {
			torck.contacts--;
		}
	}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	listener.PostSolve = function(contact, impulse) {

	}